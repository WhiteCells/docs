### 共享内存

共享内存允许多个进程共享物理内存的同一个区域（通常称为段）

与管道等要求发送进程将数据从用户空间的缓冲区复制进内核内存，接收进程将数据从内核内存复制到用户空间的缓冲区相比，共享内存的速度更快。

### 共享内存使用步骤

调用 `shmget()` 创建一个共享内存段，或取得一个存在的共享内存段的标识符，调用返回后续调用中需要使用到的共享内存标识符。

使用 `shmat()` 附上内存共享段，即使该段成为调用内存的虚拟内存的一部分。

引用共享内存段需要使用 `shmat()` 返回的 addr 值，是一个指向进程的虚拟地址空间中该共享内存段的起点的指针。

调用 `shmdt()` 分离共享内存段，进程无法再引用这块内存，这一步可选，并且在进程终止时自动完成。

调用 `shmctl()` 删除共享内存段，仅当**所有附加内存段的进程都与之分离之后共享内存段才会销毁**（假设多个进程共享内存段，只有这些进程都与共享内存段分离之后共享内存段才会销毁），只有一个进程需要执行这一步。